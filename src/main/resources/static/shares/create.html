<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0,maximum-scale=1.0,user-scalable=0" name="viewport"/>
    <title>生成海报</title>
    <link href="./dialog/css/dialog.css" rel="stylesheet" type="text/css"/>
    <link href="./dialog/css/tmpl.css" rel="stylesheet" type="text/css"/>
    <link href="./css/poster.css" rel="stylesheet" type="text/css"/>
</head>
<body class="whiteBg">


<div class="js-lives__box">


    <div class="js-lives js-lives__item ">
        <div class="grade2"></div>

        <div class="time lives-time">2021年11月2日</div>

        <div class="intro">
            <div class="content_list">
                <a href="https://www.qinzi123.com/certificateGenerator/index.html" target="_blank"
                   class="titles  lives-titles"></a>
                <a href="https://www.qinzi123.com/certificateGenerator/index.html" target="_blank" class="lives-desc"
                   style="color: rgb(118, 118, 128);"></a>
            </div>
        </div>

        <div class="js-lives__tools resource">
            <ol class="js-lives__share share-btn">
                <a href="javascript:;" class="like share">手机端分享</a>
            </ol>
        </div>

    </div>


    <div class="js-lives js-lives__item ">
        <div class="grade2"></div>

        <div class="time lives-time">2021年11月3日</div>

        <div class="intro">
            <div class="content_list">
                <a href="https://www.qinzi123.com/certificateGenerator/index.html" target="_blank"
                   class="titles  lives-titles">1</a>
                <a href="https://www.qinzi123.com/certificateGenerator/index.html" target="_blank" class="lives-desc"
                   style="color: rgb(118, 118, 128);">1</a>
            </div>
        </div>

        <div class="js-lives__tools resource">
            <ol class="js-lives__share share-btn">
                <a href="javascript:;" class="like share">手机端分享</a>
            </ol>
        </div>

    </div>
</div>


<!--     <div class="content">
        <div class="o-scroll padB0">
            <div class="posterImg" id="posterImg">
                <div class="posterImg-title">
                    <div class="logos"><img src="/skin/img/logo.png" alt=""></div>
                    <div class="posterImg-xxkx">
                    <span>消</span>
                    <span>息</span>
                    <span>快</span>
                    <span>讯</span>
                    </div>
                </div>
                <div class="posterImg-cont">
                    <div class="ptitles">Metaverse元宇宙：游戏系通往虚拟现实虚拟现实虚拟现实</div>
                    <div class="ptimes">2021年11月4日&nbsp;&nbsp;14:19</div>
                    <div class="pdesc">11月3日消息，为提升贸易融资便利化水平，助推粤港澳大湾区互联互通，作为跨平台项目的首批合作银行之一，中国银行深圳市分行于10月27日成功联动中国银行（香港）完成首笔中国人民银行贸易金融区块链平台（简称“贸金区块链平台”）二期项目试点，落地跨平台、跨境数据互通下的首批进口贸易融资业务，进一步拓宽了深港两地贸易金融区块链平台互联互通的深度与广度。（深圳新闻网）</div>
                </div>
                <div class="pshares">
                <div class="pshear-fx">
                   分享自infoD
                </div>
                <div class="code_img" id="qrcode"></div>
                </div>
            </div>
         </div>
    </div> -->
<div class="shares-content">
    <div class="o-scroll padB0">
        <div class="posterImg" id="posterImg">
            <div class="posterImg-title">
                <div class="logos"><img src="./img/posterBg.jpg" alt=""></div>
                <div class="posterImg-xxkx">
                    <span>消</span>
                    <span>息</span>
                    <span>快</span>
                    <span>讯</span>
                </div>
            </div>
            <div class="posterImg-cont">
                <div class="ptitles"></div>
                <div class="ptimes"></div>
                <div class="pdesc"></div>
            </div>
            <div class="pshares">
                <div class="pshear-fx">
                    分享自infoD
                </div>
                <div class="code_img" id="qrcode"></div>
            </div>
        </div>
    </div>
</div>
<div class="lode-info-share">
    <!--    <div data-v-1eefba6c="" class="top_tips">请长按图片，将本条快讯推荐给好友</div>-->
    <div class="share-imgs"></div>
</div>


<!-- 加载层  -->
<div class="load_mask"></div>
<script src="./js/jquery-2.1.3.min.js"></script>
<!-- <script src="./js/rem.js"></script> -->
<script src="./dialog/js/dialog.js"></script>
<script src="./dialog/js/ripple.js"></script>
<script src="./dialog/js/tapEvent.js"></script>
<script src="./js/html2canvas/html2canvas.min.js"></script>
<script src="./js/qrcode/qrcode.min.js"></script>
<script type="text/javascript">
    $(function () {
        $('.share-btn').click(function () {
            var ptimes = $(this).parents('.js-lives__tools').siblings('.lives-time').html();
            var ptitles = $(this).parents('.js-lives__tools').siblings('.intro').children('.content_list').children('.lives-titles').html();
            var surl = $(this).parents('.js-lives__tools').siblings('.intro').children('.content_list').children('.lives-titles').attr('href');
            var pdesc = $(this).parents('.js-lives__tools').siblings('.intro').children('.content_list').children('.lives-desc').html();
            console.log(pdesc);
            $('.ptitles').html(ptitles);
            $('.ptimes').html(ptimes);
            $('.pdesc').html(pdesc);

            makeCode(surl);
        });
    })

    /**
     * 生成二维码
     * */
    function makeCode(surl, actId, inviterId) {
        loadMask();
        $('#qrcode').html('');
        var qrcode = new QRCode(document.getElementById("qrcode"), {
            text: surl,//二维码地址
            width: 100,
            height: 100,
            colorDark: "#070808",//二维码颜色
            colorLight: "#ffffff",//二维码背景色
            correctLevel: QRCode.CorrectLevel.L
        });
        $('#qrcode').css('display', 'block');
        setTimeout(function () {
            createPoster();
        }, 1200)
    }

    /**
     * 生成海报
     * */
    function createPoster() {
        html2canvas(document.querySelector("#posterImg")).then(canvas => {
            dataURL = canvas.toDataURL("image/png");
            document.body.appendChild(canvas);
            $("canvas,.code_img,#posterBG,#nickName").hide();
            var html = '<img src="' + dataURL + '"/>';
            $(".posterImg").css('width', '94%');
            $(".posterImg").css('margin', '0 3%');
            $(".lode-info-share").css('display', 'block');
            $(".share-imgs").html(html);
            $('.dialog').removeClass('dialog-open');
            $('.dialog-toast').remove();
            $('.load_mask').hide();
            tipHint('生成成功', 1200);
        });
    }

    /**
     * 加载层
     * */
    function loadMask() {
        $('.load_mask').show();
        $(document).dialog({
            type: 'toast',
            content: '<img class="info-icon" src="img/loading.gif" /><span class="info-text">海报生成中...</span>',
        });
    }

    /**
     * tip窗提示
     *
     * @param msg【提示信息】
     * @param time【显示时长，单位：毫秒】
     */
    function tipHint(msg, time = 2000) {
        $(document).dialog({
            type: 'notice',
            infoText: msg,
            autoClose: time
        })
    }

    $('.lode-info-share').click(function () {
        $('.lode-info-share').css('display', 'none');
    });
</script>
</body>
</html>